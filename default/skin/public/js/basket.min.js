!function(e,t){"use strict";var n=t.head||t.getElementsByTagName("head")[0],r=[],u=function(e,t){try{return localStorage.setItem("basket-"+e,JSON.stringify(t)),!0}catch(a){if(a.name.toUpperCase().indexOf("QUOTA")>=0){var n,r=[];for(n in localStorage)0===n.indexOf("basket-")&&r.push(JSON.parse(localStorage[n]));return r.length?(r.sort(function(e,t){return e.stamp-t.stamp}),basket.remove(r[0].key),u(e,t)):void 0}return}},a=function(e){return new RSVP.Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?t({content:r.responseText,type:r.getResponseHeader("content-type")}):n(new Error(r.statusText)))},setTimeout(function(){r.readyState<4&&r.abort()},basket.timeout),r.send()})},i=function(e){return a(e.url).then(function(t){var n=o(e,t);return e.skipCache||u(e.key,n),n})},o=function(e,t){var n=+new Date;return e.data=t.content,e.originalType=t.type,e.type=e.type||t.type,e.skipCache=e.skipCache||!1,e.stamp=n,e.expire=n+60*(e.expire||5e3)*60*1e3,e},c=function(e,t){return!e||e.expire-+new Date<0||t.unique!==e.unique||basket.isValidItem&&!basket.isValidItem(e,t)},s=function(e){var t,n,r;if(e.url)return e.key=e.key||e.url,t=basket.get(e.key),e.execute=!1!==e.execute,r=c(t,e),e.live||r?(e.unique&&(e.url+=(e.url.indexOf("?")>0?"&":"?")+"basket-unique="+e.unique),n=i(e),e.live&&!r&&(n=n.then(function(e){return e},function(){return t}))):(t.type=e.type||t.originalType,t.execute=e.execute,n=new RSVP.Promise(function(e){e(t)})),n},l=function(e){var r=t.createElement("script");r.defer=!0,r.text=e.data,n.appendChild(r)},f={default:l},p=function(e){return e.type&&f[e.type]?f[e.type](e):f.default(e)},d=function(e){return e.map(function(e){return e.execute&&p(e),e})},h=function(){var e,t,n=[];for(e=0,t=arguments.length;e<t;e++)n.push(s(arguments[e]));return RSVP.all(n)},y=function(){var e=h.apply(null,arguments),t=this.then(function(){return e}).then(d);return t.thenRequire=y,t};e.basket={require:function(){for(var e=0,t=arguments.length;e<t;e++)arguments[e].execute=!1!==arguments[e].execute,arguments[e].once&&r.indexOf(arguments[e].url)>=0?arguments[e].execute=!1:!1!==arguments[e].execute&&r.indexOf(arguments[e].url)<0&&r.push(arguments[e].url);var n=h.apply(null,arguments).then(d);return n.thenRequire=y,n},remove:function(e){return localStorage.removeItem("basket-"+e),this},get:function(e){var t=localStorage.getItem("basket-"+e);try{return JSON.parse(t||"false")}catch(e){return!1}},clear:function(e){var t,n,r=+new Date;for(t in localStorage)(n=t.split("basket-")[1])&&(!e||this.get(n).expire<=r)&&this.remove(n);return this},isValidItem:null,timeout:5e3,addHandler:function(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){f[e]=t})},removeHandler:function(e){basket.addHandler(e,void 0)}},basket.clear(!0)}(this,document);